{
  "kind": "build_request",
  "title": "NEXUS — Complete Auth Fix, Navigation Overhaul, Layout Audit & Full-App Polish",
  "projectName": "NEXUS",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-184",
      "text": "Rewrite frontend/src/screens/auth/LoginScreen.tsx to eliminate the infinite loop: the 'SE CONNECTER' button must call go('role') directly after a brief loading state (no canister dependency, no async block that re-renders indefinitely). The button must always be clickable, never disabled by default, and the loading state must auto-clear after 800ms if Internet Identity is unavailable. The screen must never redirect back to itself.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ],
        "quotes": [
          "il y a énormément de défauts , incohérence la navigation navigateur ne permet pas de voir toutes les éléments de la page"
        ]
      },
      "acceptanceCriteria": [
        "Clicking 'SE CONNECTER' navigates to 'role' screen within 1 second",
        "No infinite re-render loop on LoginScreen",
        "Button is never stuck in loading state permanently",
        "Screen background #050507, orbs animated, content visible"
      ]
    },
    {
      "id": "REQ-185",
      "text": "Rewrite frontend/src/state/useAppState.ts to guarantee: (1) initialState.screen is always 'login', never 'otp' or any other value; (2) initialState.role is always null; (3) the go() function has no conditional guards — it always sets state.screen to the target value unconditionally; (4) all fields introduced in prior requirements (userLat, userLng, locationActive, bookingCreneau, bookingAdresse, bookingVille, bookingPhone, bookingNote, bookingId, modalOpen, serviceEditorOpen, editingService, adminAuthenticated) are present with correct defaults (null/false); (5) showToast auto-removes after duration and enforces a max of 4 toasts (oldest removed first).",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ]
      },
      "acceptanceCriteria": [
        "App always starts on 'login' screen",
        "go() called with any valid Screen value immediately updates state.screen",
        "No navigation is ever blocked",
        "All state fields present with correct default types"
      ]
    },
    {
      "id": "REQ-186",
      "text": "Rewrite frontend/src/App.tsx with a complete, production-ready router: (1) outer wrapper position fixed inset-0 background #050507 overflow hidden; (2) on mobile (<= 899px) inner container max-width 430px width 100% height 100% margin 0 auto display flex flex-direction column overflow hidden position relative; (3) on desktop (>= 900px) inner container max-width 1100px two-column CSS grid — sidebar 220px left, main content right; (4) renderScreen() switch covers all 28 cases with zero fallthrough: login, role, otp, explorer, fiche_pro, booking_1, booking_2, booking_3, booking_4, booking_5, live_status, client_reservations, client_alertes, client_profil, pro_dashboard, pro_radar, pro_wallet, pro_business, pro_subscription, pro_success, admin_login, admin_dashboard, admin_pros, admin_bookings, admin_revenus — default falls back to LoginScreen; (5) screen container uses key={state.screen} with fadeIn 200ms opacity animation on each navigation; (6) sidebar (desktop only) renders role-appropriate vertical nav items (56px height each) matching the current role; (7) bottom tab bars hidden on desktop via display:none at >=900px; (8) Toast and NotifsPanel rendered as overlays; (9) all screens receive go, state, update, showToast, removeToast props.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ]
      },
      "acceptanceCriteria": [
        "All 28 screen cases present and independently renderable",
        "No fallthrough between switch cases",
        "Desktop sidebar visible and functional at >= 900px",
        "Bottom tab bars hidden at >= 900px",
        "Screen transition fadeIn animation fires on every navigation",
        "Toast and NotifsPanel render above all screens"
      ]
    },
    {
      "id": "REQ-187",
      "text": "Audit and fix the root layout of every screen to ensure all content is visible without hidden overflow on both mobile and desktop. Rules for every screen: (1) root element must be position fixed inset-0, display flex, flex-direction column — never a fixed px height; (2) header is position absolute top-0 left-0 right-0 height 56px z-index 100; (3) scroll zone is flex-1 overflow-y auto -webkit-overflow-scrolling touch overscroll-behavior contain padding-top 72px — never overflow hidden, never fixed height; (4) tab bar and CTA zone are flex-shrink-0 in natural flex flow — never position fixed; (5) no black empty space anywhere. Apply to: LoginScreen, RoleScreen, OTPScreen, ExplorerScreen, FicheProScreen, Booking1–5, LiveStatusScreen, ReservationsScreen, AlertesScreen, ClientProfilScreen, ProDashboardScreen, ProRadarScreen, ProWalletScreen, ProBusinessScreen, SubscriptionModal, SuccessScreen, AdminLoginScreen, AdminDashboardScreen, AdminProsScreen, AdminBookingsScreen, AdminRevenusScreen.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ],
        "quotes": [
          "la navigation navigateur ne permet pas de voir toutes les éléments de la page"
        ]
      },
      "acceptanceCriteria": [
        "Every screen scrolls its content without overflow hidden cutting it off",
        "No screen has a black empty zone at the bottom",
        "Tab bar always visible at the bottom in natural flex flow",
        "CTA button always anchored at the bottom and never hidden",
        "Verified on both mobile (430px) and desktop (1100px)"
      ]
    },
    {
      "id": "REQ-188",
      "text": "Refine frontend/src/styles/globals.css with all missing fixes: (1) add height: 100dvh on the html and body root; (2) add --safe-bottom: env(safe-area-inset-bottom, 8px); (3) .screen-root { position: fixed; inset: 0; display: flex; flex-direction: column; background: var(--void); }; (4) .scroll-zone { flex: 1; overflow-y: auto; -webkit-overflow-scrolling: touch; overscroll-behavior: contain; touch-action: pan-y; }; (5) .cta-zone { flex-shrink: 0; padding: 12px 20px calc(12px + var(--safe-bottom)); background: rgba(5,5,7,0.97); border-top: 1px solid rgba(255,255,255,0.04); }; (6) .tab-bar { flex-shrink: 0; }; (7) ensure all keyframe animations (fadeIn, breathe, shimmer, fall, progressFill, scaleIn, slideUp, slideDown, float, spin) are fully defined with correct will-change GPU hints; (8) .glass-card, .gold-text, .glow-gold utility classes correct at all breakpoints; (9) media query breakpoints at 430px, 768px, 900px; (10) body font-size 15px at >= 768px; (11) smooth scroll on html element; (12) overscroll-behavior: contain on all scroll zones.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ]
      },
      "acceptanceCriteria": [
        "No screen exceeds 100dvh",
        "Safe-area bottom padding applied on iOS",
        "All keyframe animations run without jank",
        "Glass-card, gold-text, glow-gold utilities visible at all breakpoints",
        "Overscroll pull-to-refresh bleed eliminated"
      ]
    },
    {
      "id": "REQ-189",
      "text": "Fix the OTP authentication flow to eliminate infinite loops and blocked navigation: (1) OTPScreen has a role guard at the very top — if state.role is null, call go('role') and return null immediately; (2) the 'Send code' button uses the twilio.ts stub (accepts any 4-digit code) — it must never block on a real network call; (3) on entering all 4 digits, verifyOTP() is called locally — any 4-digit code is accepted in demo mode; (4) on success: if role==='client' call go('explorer'), if role==='pro' call go('pro_dashboard'), if role==='admin' call go('admin_dashboard'); (5) the phone number input with +41 prefix is pre-filled and the step to enter code auto-advances without requiring a real SMS; (6) resend countdown is 60 seconds using setInterval.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ],
        "quotes": [
          "la connexion elle tourne en boucle et on arrive pas à voir les étapes d'après"
        ]
      },
      "acceptanceCriteria": [
        "OTPScreen never renders when role is null",
        "Any 4-digit code is accepted and navigates to the correct role screen",
        "No network dependency blocking the OTP flow",
        "Phone input with +41 prefix visible and functional",
        "Resend button activates after 60 seconds"
      ]
    },
    {
      "id": "REQ-190",
      "text": "Fix all buttons across the entire application: every button must have a functional onClick handler, no button may be permanently disabled without a visible reason, all gold gradient CTA buttons must be visible and tappable. Specifically: (1) every BtnPrimary instance has an onClick that performs a visible action; (2) disabled state only applied when an explicit condition is not met (e.g. no service selected, no address entered) with a visual explanation; (3) no button renders with opacity 0 or visibility hidden; (4) active press state scale(0.96) applies on all buttons.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ],
        "quotes": [
          "il y a énormément de défauts"
        ]
      },
      "acceptanceCriteria": [
        "Zero buttons with missing onClick",
        "All CTA gold buttons visible and functional",
        "Disabled state shown only with clear condition",
        "Press scale micro-interaction on all buttons"
      ]
    },
    {
      "id": "REQ-191",
      "text": "Fix all form inputs across the entire application: every input and textarea must be fully controlled with value and onChange props, every input must have a visible label above it, placeholder text must be informative, real-time validation with error messages in #FF3D5A below the field, font-size minimum 16px on all inputs and textareas to prevent iOS zoom, height 52px on all inputs.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ]
      },
      "acceptanceCriteria": [
        "All inputs have value and onChange",
        "All inputs have a visible label",
        "Validation errors shown in #FF3D5A",
        "Font-size >= 16px on all inputs and textareas",
        "Height 52px on all inputs"
      ]
    },
    {
      "id": "REQ-192",
      "text": "Fix all images across the application: every img tag must have onError={(e) => { e.currentTarget.onerror = null; e.currentTarget.style.display = 'none'; }} AND a sibling gradient fallback div that is always rendered behind the image (using position absolute, inset 0, linear-gradient background). Every image must have loading='lazy' and object-fit='cover'. This applies to ExplorerScreen cards, FicheProScreen cover and gallery, TabGalerie previews, and any other img tags.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ]
      },
      "acceptanceCriteria": [
        "No broken image icon visible anywhere",
        "Gradient fallback shows whenever image fails to load",
        "All images have loading='lazy' and object-fit='cover'",
        "onError handler prevents repeated error callbacks"
      ]
    },
    {
      "id": "REQ-193",
      "text": "Ensure demo data is always visible on every screen — no screen ever shows an empty state as its only content on first load. Specifically: ExplorerScreen always shows the 6 PROS_DEMO entries on mount (before any canister call); ProRadarScreen always shows 2 demo booking requests; ProWalletScreen always shows balance 240 CHF, escrow 55 CHF, 5 demo transactions, and 7-bar chart; ReservationsScreen always shows 3 demo upcoming bookings; AlertesScreen always shows 4 demo notifications (3 unread); AdminDashboardScreen always shows demo KPIs (8 pros, 47 clients, 156 CHF revenue, 24 transactions), 3 pending pros, 5 recent bookings; AdminProsScreen always shows demo pros list; AdminBookingsScreen always shows demo bookings; AdminRevenusScreen always shows demo revenue data. All canister calls are wrapped in try/catch — on error or empty result, demo data is used.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ]
      },
      "acceptanceCriteria": [
        "Every screen shows meaningful content immediately on mount",
        "No screen displays only an empty state container",
        "Demo data persists when canister throws or returns empty",
        "All 6 PROS_DEMO entries visible in ExplorerScreen without interaction"
      ]
    },
    {
      "id": "REQ-194",
      "text": "Fix all navigation inconsistencies: (1) every screen that has a back arrow must call go() with the correct previous screen — no dead-end screens; (2) the NEXUS logo on the Header is always clickable and navigates to the role-appropriate home screen (explorer for client, pro_dashboard for pro, admin_dashboard for admin); (3) the role-switch pill in ExplorerScreen (labeled 'Pro') calls go('pro_dashboard'), and in ProDashboardScreen the client switch pill calls go('explorer'); (4) all 4 tabs in TabBarClient navigate: explorer → go('explorer'), reservations → go('client_reservations'), alertes → go('client_alertes'), profil → go('client_profil'); (5) all 4 TabBarPro tabs navigate: radar → go('pro_radar'), wallet → go('pro_wallet'), dashboard → go('pro_dashboard'), business → go('pro_business'); (6) all 4 TabBarAdmin tabs navigate: dashboard → go('admin_dashboard'), pros → go('admin_pros'), bookings → go('admin_bookings'), revenus → go('admin_revenus').",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ]
      },
      "acceptanceCriteria": [
        "Every screen reachable from at least one navigation action",
        "Logo click navigates to role-appropriate home",
        "All tab bar tabs navigate to correct screens",
        "Role switch pill navigates correctly in both directions",
        "No screen is a dead end without a way out"
      ]
    },
    {
      "id": "REQ-195",
      "text": "Fix the complete 5-step booking flow end-to-end: (1) Booking1Screen: services from state.selectedPro.services or 5 category defaults if empty, selecting a service calls update({ selectedService }), Continue active only when service selected, calls go('booking_2'); (2) Booking2Screen: 4 fixed time slots ('In 1 hour', 'In 2 hours', 'This evening', 'Tomorrow morning'), selecting calls update({ bookingCreneau: slot }), Continue calls go('booking_3'); (3) Booking3Screen: phone (optional, validates /^\\+41[0-9]{9}$/ or empty), address (required), city dropdown 12 cities (required), note optional; Continue active only when address and city valid, calls update({ bookingAdresse, bookingVille, bookingPhone, bookingNote }) then go('booking_4'); (4) Booking4Screen: displays full recap (service name, duration, slot, address, city, total price in Inter 800 28px #F2D06B), CTA 'Confirm and pay via TWINT' — on click calls update({ bookingId: 'demo_' + Date.now() }), showToast('Booking request sent', 'success'), go('booking_5'); (5) Booking5Screen: animated SVG hourglass, 30-min countdown, after exactly 8 seconds calls go('live_status') and showToast('Booking confirmed', 'success').",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ]
      },
      "acceptanceCriteria": [
        "Full booking flow completable without any canister dependency",
        "Each step preserves data in global state",
        "Booking4 CTA navigates to booking_5 and shows toast",
        "Booking5 auto-navigates to live_status after exactly 8 seconds",
        "Zero emoji, zero Stripe"
      ]
    },
    {
      "id": "REQ-196",
      "text": "Fix ProBusinessScreen and all 5 tabs to work fully without any canister dependency: (1) ProBusinessScreen layout: position fixed inset-0, flex column, header absolute 56px z-100, tab zone flex-shrink-0 padding-top 72px, scroll zone flex-1 overflow-y auto, CTA zone flex-shrink-0, TabBarPro flex-shrink-0 — zero black empty space; (2) tab pills Profile/Services/Schedule/Payment/Gallery all clickable with correct active styling and completion micro-dots; (3) ProgressCircle and 5-segment bar update based on filled fields; (4) 'Save and continue' button on tabs 1–4 shows spinner 600ms then advances tab and shows showToast('Information saved', 'success'); (5) Tab 5 Gallery: 'Activate my profile' button active when photo count >= 3, calls update({ modalOpen: true }); disabled with 'Profile incomplete X%' text when < 80% completion; (6) SubscriptionModal renders as bottom overlay when state.modalOpen is true; (7) SubscriptionModal 'Start for free' button: if VITE_PAYREXX_SECRET undefined, calls update({ proActif: true }) then go('pro_success').",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ]
      },
      "acceptanceCriteria": [
        "All 5 tabs render without errors and show content",
        "Save and continue advances tabs with toast feedback",
        "Gallery tab file upload previews work via FileReader",
        "SubscriptionModal opens from tab 5 activate button",
        "SubscriptionModal fallback navigates to pro_success",
        "Zero black empty space in ProBusinessScreen"
      ]
    },
    {
      "id": "REQ-197",
      "text": "Fix the AdminLoginScreen to use local credential check only: email 'admin@nexus.ch' password 'Admin2024!' — on match calls update({ adminAuthenticated: true }) then go('admin_dashboard'), on mismatch calls showToast('Incorrect credentials', 'error'). Both inputs are fully controlled with onChange. The Sign in button background is #FF3D5A. No canister call. The screen background is #050507 with vertically centered content.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ]
      },
      "acceptanceCriteria": [
        "Credentials admin@nexus.ch / Admin2024! grant access",
        "Wrong credentials show error toast",
        "No canister dependency",
        "Both inputs controlled with value and onChange"
      ]
    },
    {
      "id": "REQ-198",
      "text": "Enforce global visual consistency across every screen and component: (1) all text on gold (#F2D06B) backgrounds uses color #050507 — no exceptions; (2) all primary text on dark backgrounds uses #F4F4F8; (3) secondary text uses #9898B4; (4) inactive/placeholder text uses #54546C; (5) card backgrounds use #0D0D13 or #121219 — never #000000; (6) all card border-radius: buttons 14px, cards 16–18px, pills 999px, inputs 12px, modals 24px; (7) all input heights 52px; (8) all CTA button heights 56px; (9) all horizontal section padding 20px; (10) all element spacing in multiples of 8px; (11) zero emoji in any user-facing string or JSX text anywhere in the codebase.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ],
        "quotes": [
          "sans émotifs ,sans émoticônes"
        ]
      },
      "acceptanceCriteria": [
        "No invisible text (dark on dark or light on light)",
        "Zero emoji in any rendered text",
        "All gold backgrounds have #050507 text",
        "Consistent border-radius values across all components",
        "All inputs 52px height, all CTAs 56px height"
      ]
    },
    {
      "id": "REQ-199",
      "text": "Ensure the desktop sidebar in App.tsx renders the correct vertical navigation items based on the current role: (1) for role='client': 4 items matching TabBarClient (Explorer with IconSearch, Reservations with IconCalendar, Alertes with IconBell, Profil with IconUser), each calling the correct go() on click; (2) for role='pro': 4 items matching TabBarPro (Radar with IconRadar, Wallet with IconWallet, Home with IconHome, Business with IconEdit); (3) for role='admin': 4 items matching TabBarAdmin (Dashboard with IconGrid, Pros with IconUser, Bookings with IconCalendar, Revenue with IconWallet) using #FF3D5A active color; (4) sidebar nav items are 56px height, Inter 600 14px, gold (#F2D06B) when active; (5) sidebar only renders on desktop >= 900px — hidden on mobile; (6) sidebar background rgba(5,5,7,0.97), border-right 1px solid rgba(255,255,255,0.04).",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ]
      },
      "acceptanceCriteria": [
        "Sidebar renders correctly for client, pro, and admin roles",
        "Active sidebar item highlighted in role-appropriate color",
        "Sidebar hidden on viewport < 900px",
        "All sidebar nav items navigate to correct screens",
        "Sidebar background and border correct"
      ]
    },
    {
      "id": "REQ-200",
      "text": "Rewrite frontend/src/components/Header.tsx with complete functionality: position absolute top-0 left-0 right-0, height 56px (mobile) / 64px (desktop >= 900px), background rgba(5,5,7,0.97), backdrop-filter blur(32px), border-bottom 1px solid rgba(255,255,255,0.04), z-index 100. Left: if showBack — 40px circle button background #0D0D13 border rgba(255,255,255,0.08) with IconArrowLeft 18px #F4F4F8 onClick onBack; else — 'NEXUS' Inter 900 22px #F4F4F8 + '.' in #5B7FFF letter-spacing -0.05em, onClick onLogoClick. Center: title Inter 700 16px #F4F4F8 with fadeIn 300ms. Right: role-switch pill (transition 150ms border-color) + notification bell (40px circle, badge scaleIn 200ms when notifsCount > 0 in #FF3D5A). All props (showBack, onBack, title, role, notifsCount, onNotifs, onSwitchRole, onLogoClick) typed and functional.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ]
      },
      "acceptanceCriteria": [
        "Header renders correctly with all prop combinations",
        "Back button navigates correctly when showBack is true",
        "Logo click calls onLogoClick",
        "Notification badge appears when notifsCount > 0",
        "Role switch pill shows correct label and calls onSwitchRole"
      ]
    },
    {
      "id": "REQ-201",
      "text": "Rewrite frontend/src/components/BtnPrimary.tsx: height 56px (non-small), 60px on desktop >= 768px; font-size 15px (mobile) / 16px (desktop); border-radius 14px (mobile) / 16px (desktop); gold gradient background with glow-gold box-shadow 0 6px 28px rgba(242,208,107,0.3); disabled state background #1C1C26 color #54546C box-shadow none cursor not-allowed; danger state background #FF3D5A box-shadow 0 6px 24px rgba(255,61,90,0.3) color #fff; loading state: 18x18px spinner border 2px solid currentColor border-top-color transparent animation spin 0.8s infinite; active press scale(0.96) transition 100ms; flex-shrink 0 always; box-shadow transition 200ms.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ]
      },
      "acceptanceCriteria": [
        "Gold gradient button visible with glow shadow",
        "Disabled state uses #1C1C26 with no shadow",
        "Loading spinner centered and spinning",
        "Press scale micro-interaction on active",
        "flex-shrink 0 always applied"
      ]
    },
    {
      "id": "REQ-202",
      "text": "Rewrite frontend/src/components/Toast.tsx: container position fixed top 72px, on mobile left 16px right 16px max-width 430px, on desktop >= 768px right-aligned 24px from right edge max-width 360px; each toast backdrop-filter blur(24px) background rgba(9,9,13,0.97) border 1px solid rgba(255,255,255,0.06); type-based icon in 24px circle (IconCheck #00D97A success, IconX #FF3D5A error, IconBell #5B7FFF info, IconFlash #F2D06B sms); text Inter 500 13px #F4F4F8; enter slideDown 300ms exit slideUp 200ms; gap 8px; max 4 toasts (oldest removed); auto-dismiss after duration ?? 3500ms; on desktop border-radius 16px padding 16px 20px.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ]
      },
      "acceptanceCriteria": [
        "Toasts appear at top of screen without obscuring content",
        "Type-based icons visible in correct colors",
        "Max 4 toasts enforced",
        "Auto-dismiss after 3500ms",
        "Desktop right-alignment at >= 768px"
      ]
    },
    {
      "id": "REQ-203",
      "text": "Rewrite frontend/src/components/BottomSheet.tsx: on mobile, bottom-anchored border-radius 24px 24px 0 0, max-height calc(100dvh - 64px - env(safe-area-inset-bottom,0px)), slideUp 250ms animation, drag handle visible. On desktop >= 768px: centered modal position fixed top 50% left 50% transform translate(-50%,-50%) max-width 560px border-radius 24px all corners max-height 85vh, enter animation scaleIn. Overlay rgba(5,5,7,0.85) blur(4px). Content scrollable with flex-1 overflow-y auto. Footer slot sticky at bottom. onClick overlay calls onClose, onClick sheet stopPropagation.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ]
      },
      "acceptanceCriteria": [
        "Bottom-anchored on mobile with drag handle",
        "Centered modal on desktop >= 768px",
        "Content area scrollable",
        "Footer sticky at bottom",
        "Overlay click closes sheet"
      ]
    },
    {
      "id": "REQ-204",
      "text": "Rewrite frontend/src/components/TabBarClient.tsx, TabBarPro.tsx, and TabBarAdmin.tsx: on desktop >= 900px, hide entirely with display:none (navigation handled by sidebar). On mobile, full polish: gold indicator line width transition 0→24px 200ms on mount, active icon scale(1.1) 150ms transition, inactive icons #2E2E3E, active icons and labels #F2D06B (TabBarAdmin uses #FF3D5A for active). Gradient top border linear-gradient(to right, transparent, rgba(242,208,107,0.15), transparent). Tab press scale(0.9) briefly. All tab onClick handlers call the correct go() navigation. Add aria-label attributes to all tab buttons.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ]
      },
      "acceptanceCriteria": [
        "Tab bars hidden at >= 900px",
        "All navigation handlers call correct go() targets",
        "Gold indicator line animated on mount",
        "Active icon scaled up 1.1x",
        "aria-label on all tab buttons"
      ]
    },
    {
      "id": "REQ-205",
      "text": "Rewrite frontend/src/components/NotifsPanel.tsx: on mobile, full-width slide-in from right width 100% max-width 430px. On desktop >= 900px: right-side drawer max-width 400px, semi-transparent left border 1px solid rgba(255,255,255,0.08). Notification items stagger fadeIn 30ms per index. Each type has distinct icon — nouvelle_demande: IconBell, paiement_confirme: IconWallet, fonds_liberes: IconBank, booking_confirme: IconCalendar, avis_recu: IconStar — in correctly colored 36px circles. Panel header: count chip Inter 700 11px #050507 on #F2D06B padding 2px 7px border-radius 999px. Entrance slideUp 300ms cubic-bezier(0.32,0.72,0,1). Thin #2E2E3E bar on left edge as swipe hint.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ]
      },
      "acceptanceCriteria": [
        "Panel slides in from right on mobile",
        "Desktop drawer max-width 400px with left border",
        "All 5 notification types have correct icons",
        "Count chip visible in header",
        "Staggered fadeIn animation on notification items"
      ]
    }
  ],
  "constraints": [
    "Zero emoji in any user-facing string or JSX text",
    "Zero Stripe, zero Revolut — TWINT only via Payrexx",
    "No React Router — navigation via useAppState go() only",
    "No Tailwind CSS — inline styles only",
    "No external UI libraries except those already in use",
    "Internet Identity login must not block navigation to role screen if II popup fails",
    "All canister calls must be wrapped in try/catch with demo data fallback",
    "Do not modify files in frontend/src/hooks/ or frontend/src/components/ui/ immutable paths"
  ],
  "nonGoals": [
    "Real SMS sending via Twilio (stub only)",
    "Real Payrexx payment processing (URL builder only, redirects to Payrexx)",
    "Real-time WebSocket or push notification features",
    "Backend Motoko changes unless required by frontend fix",
    "New screens or features not already defined in existing requirements",
    "Third-party authentication other than Internet Identity"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}